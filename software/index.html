<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Реалізація інформаційного та програмного забезпечення | Розробка RESTful API на ASP.NET Core</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/edu-dis-labs/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="description" content="Лабораторні роботи з дисципліни "Розподілені інформаційні системи"">
    
    <link rel="preload" href="/edu-dis-labs/assets/css/0.styles.178e1a70.css" as="style"><link rel="preload" href="/edu-dis-labs/assets/js/app.ee704347.js" as="script"><link rel="preload" href="/edu-dis-labs/assets/js/2.687b822f.js" as="script"><link rel="preload" href="/edu-dis-labs/assets/js/21.e6303add.js" as="script"><link rel="prefetch" href="/edu-dis-labs/assets/js/10.cc316f46.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/11.f89fdfa3.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/12.d9af3753.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/13.b8dd9aae.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/14.ecc228d2.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/15.8727b151.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/16.a73ffab0.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/17.7deba347.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/18.edf16138.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/19.25941726.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/20.73f1d81e.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/22.df6d96e6.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/23.046e53e5.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/24.52ca8d4e.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/3.bb30875e.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/4.5042fbeb.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/5.59b22d4c.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/6.aeddef27.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/7.4bdd093e.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/8.e2d1a40b.js"><link rel="prefetch" href="/edu-dis-labs/assets/js/9.98cec62e.js">
    <link rel="stylesheet" href="/edu-dis-labs/assets/css/0.styles.178e1a70.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/edu-dis-labs/" class="home-link router-link-active"><!----> <span class="site-name">Розробка RESTful API на ASP.NET Core</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/edu-dis-labs/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/inovarka/edu-dis-labs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/edu-dis-labs/" class="nav-link">
  Початок
</a></div> <a href="https://github.com/inovarka/edu-dis-labs" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/edu-dis-labs/intro/" class="sidebar-link">Вступ</a></li><li><a href="/edu-dis-labs/requirements/" class="sidebar-link">Розроблення вимог до системи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#основні-визначення" class="sidebar-link">Основні визначення</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#http-і-restful-веб-сервіси" class="sidebar-link">HTTP і RESTful веб-сервіси</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#ресурс" class="sidebar-link">Ресурс</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#uri-ресурса" class="sidebar-link">URI ресурса</a></li></ul></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#rest-і-ресурси" class="sidebar-link">REST і Ресурси</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#компоненти-http" class="sidebar-link">Компоненти HTTP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#методи-http-запиту" class="sidebar-link">Методи HTTP-запиту</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#код-статусу-відповіді-http" class="sidebar-link">Код статусу відповіді HTTP</a></li></ul></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/requirements/#висновки" class="sidebar-link">Висновки</a></li></ul></li><li><a href="/edu-dis-labs/design/" class="sidebar-link">Проєктування архітектури системи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/design/#restful-архітектура" class="sidebar-link">RESTful архітектура</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/design/#принципи-та-обмеження-restful" class="sidebar-link">Принципи та обмеження RESTful</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/design/#restful-клієнт-сервер" class="sidebar-link">RESTful клієнт-сервер</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/design/#відсутність-стану" class="sidebar-link">Відсутність стану</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/design/#кеш" class="sidebar-link">Кеш</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/design/#багатошарова-система" class="sidebar-link">Багатошарова система</a></li></ul></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/design/#опис" class="sidebar-link">Опис</a></li></ul></li><li><a href="/edu-dis-labs/software/" aria-current="page" class="active sidebar-link">Реалізація інформаційного та програмного забезпечення</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#створення-проекту" class="sidebar-link">Створення проекту</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#додавання-класу-моделі" class="sidebar-link">Додавання класу моделі</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#додавання-класу-репозиторію" class="sidebar-link">Додавання класу репозиторію</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#регістрація-репозиторію" class="sidebar-link">Регістрація репозиторію</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#додавання-контролеру" class="sidebar-link">Додавання контролеру</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#отримання-елементів-списку-справ" class="sidebar-link">Отримання елементів списку справ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#маршрутизація-та-url-шляхи" class="sidebar-link">Маршрутизація та URL-шляхи</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#значення-що-повертаються" class="sidebar-link">Значення, що повертаються</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/software/#запуск-програми" class="sidebar-link">Запуск програми</a></li></ul></li></ul></li><li><a href="/edu-dis-labs/test/" class="sidebar-link">Тестування працездатності системи</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/test/#реалізація-інших-операціи-crud" class="sidebar-link">Реалізація інших операцій CRUD</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/edu-dis-labs/test/#create" class="sidebar-link">Create</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/test/#використання-postman-для-надсилання-запиту-create" class="sidebar-link">Використання Postman для надсилання запиту Create</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/test/#update" class="sidebar-link">Update</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/test/#update-з-використанням-patch" class="sidebar-link">Update з використанням Patch</a></li><li class="sidebar-sub-header"><a href="/edu-dis-labs/test/#delete" class="sidebar-link">Delete</a></li></ul></li></ul></li><li><a href="/edu-dis-labs/conclusion/" class="sidebar-link">Висновки</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="реалізація-інформаціиного-та-програмного-забезпечення"><a href="#реалізація-інформаціиного-та-програмного-забезпечення" class="header-anchor">#</a> Реалізація інформаційного та програмного забезпечення</h1> <h2 id="створення-проекту"><a href="#створення-проекту" class="header-anchor">#</a> Створення проекту</h2> <ul><li>Використовую <strong>IDE Visual Studio</strong></li> <li>Запустіть Visual Studio. У меню <strong>File</strong> виберіть <strong>New &gt; Project</strong>. Виберіть шаблон проекту <strong>ASP.NET Core Web Application (.NET Core)</strong>. Назвіть проект <code>TodoApi</code>, зніміть позначку <strong>Host in the cloud</strong> та натисніть <strong>OK</strong>.</li> <li>У вікні <strong>New ASP.NET Core Web Application (.NET Core) - TodoApi</strong> виберіть шаблон <strong>Web API</strong>. Натисніть <strong>O</strong>K.</li></ul> <h2 id="додавання-класу-моделі"><a href="#додавання-класу-моделі" class="header-anchor">#</a> Додавання класу моделі</h2> <p>Модель – це об'єкт, який представляє дані у нашому додатку. У разі єдина модель — це елемент списку справ.</p> <p>Додати каталог з ім'ям «Models». У браузері рішень натисніть праву кнопку миші на проекті. Виберіть <strong>Add &gt; New Folder</strong>. Введіть назву каталогу <strong>Models</strong>.</p> <p>Примітка: класи моделі можуть знаходитись у будь-якому місці проекту, але зазвичай їх розміщують у каталозі <strong>Models</strong>.</p> <p>Додати клас <code>TodoItem</code>. Натисніть праву кнопку миші на каталозі <strong>Models</strong> та виберіть <strong>Add &gt; Class</strong>. Введіть ім'я класу <code>TodoItem</code> та натисніть <strong>Add</strong>.</p> <p>Замініть сформований код наступним:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">namespace</span> <span class="token namespace">TodoApi<span class="token punctuation">.</span>Models</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TodoItem</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Key <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> IsComplete <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="додавання-класу-репозиторію"><a href="#додавання-класу-репозиторію" class="header-anchor">#</a> Додавання класу репозиторію</h2> <p><strong>Репозиторій</strong> - це об'єкт, який інкапсулює рівень даних і містить логіку для отримання даних і напрямках їх до моделі. Хоча у цьому додатку немає бази даних, має сенс показати, як можна впроваджувати репозиторії в контролери. Створіть код репозиторію у каталозі <strong>Models</strong>.</p> <p>Почніть з визначення інтерфейсу репозиторію під назвою <code>ITodoRepository</code>. Використовуйте шаблон класу (<strong>Add New Item &gt; Class</strong>).</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">TodoApi<span class="token punctuation">.</span>Models</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ITodoRepository</span>
    <span class="token punctuation">{</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token class-name">TodoItem</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TodoItem<span class="token punctuation">&gt;</span></span> <span class="token function">GetAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token return-type class-name">TodoItem</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token return-type class-name">TodoItem</span> <span class="token function">Remove</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token class-name">TodoItem</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Цей інтерфейс визначає основні операції CRUD.</p> <p>Потім додайте клас <code>TodoRepository</code>, який реалізує <code>ITodoRepository</code>:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Concurrent</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">TodoApi<span class="token punctuation">.</span>Models</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TodoRepository</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ITodoRepository</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> TodoItem<span class="token punctuation">&gt;</span></span> _todos <span class="token operator">=</span>
              <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ConcurrentDictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> TodoItem<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token function">TodoRepository</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">TodoItem</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> <span class="token string">&quot;Item1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TodoItem<span class="token punctuation">&gt;</span></span> <span class="token function">GetAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">return</span> _todos<span class="token punctuation">.</span>Values<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Add</span><span class="token punctuation">(</span><span class="token class-name">TodoItem</span> item<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            item<span class="token punctuation">.</span>Key <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _todos<span class="token punctuation">[</span>item<span class="token punctuation">.</span>Key<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name">TodoItem</span> <span class="token function">Find</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">TodoItem</span> item<span class="token punctuation">;</span>
            _todos<span class="token punctuation">.</span><span class="token function">TryGetValue</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">out</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name">TodoItem</span> <span class="token function">Remove</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">TodoItem</span> item<span class="token punctuation">;</span>
            _todos<span class="token punctuation">.</span><span class="token function">TryRemove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">out</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token class-name">TodoItem</span> item<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            _todos<span class="token punctuation">[</span>item<span class="token punctuation">.</span>Key<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="регістрація-репозиторію"><a href="#регістрація-репозиторію" class="header-anchor">#</a> Регістрація репозиторію</h2> <p>При визначенні інтерфейсу репозиторію ми можемо відокремити клас репозиторію від контролера MVC, який його використовує. Замість реалізації <code>TodoRepository</code> усередині контролера ми впровадимо <code>TodoRepository</code>, використовуючи вбудовану в ASP.NET Core підтримку <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-6.0" target="_blank" rel="noopener noreferrer">запровадження залежностей<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Такий підхід полегшує модульне тестування контролерів. Модульні тести впроваджують фіктивну або імітаційну версію <code>ITodoRepository</code>. У цьому випадку тест орієнтований на логіку контролера, а не на рівень доступу до даних.</p> <p>Для застосування репозиторію в контролер необхідно зареєструвати його за допомогою контейнерів DI. Відкрийте файл <strong>Startup.cs</strong>. Додайте наступну директиву using:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">using</span> <span class="token namespace">TodoApi<span class="token punctuation">.</span>Models</span><span class="token punctuation">;</span>
</code></pre></div><p>До методу <code>ConfigureServices</code> додайте виділений код:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Add framework services.</span>
    services<span class="token punctuation">.</span><span class="token function">AddMvc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ITodoRepository<span class="token punctuation">,</span> TodoRepository<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="додавання-контролеру"><a href="#додавання-контролеру" class="header-anchor">#</a> Додавання контролеру</h2> <p>У браузері рішень натисніть праву кнопку миші на каталозі <strong>Controllers</strong>. Виберіть <strong>Add &gt; New Item</strong>. У вікні <strong>Add New Item</strong> виберіть шаблон** Web API Controller Class**. Введіть назву класу <code>TodoController</code>.</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Mvc</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">TodoApi<span class="token punctuation">.</span>Models</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">TodoApi<span class="token punctuation">.</span>Controllers</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Route</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;api/[controller]&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TodoController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Controller</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token function">TodoController</span><span class="token punctuation">(</span><span class="token class-name">ITodoRepository</span> todoItems<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            TodoItems <span class="token operator">=</span> todoItems<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name">ITodoRepository</span> TodoItems <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Отже визначається клас порожнього контролера. У наступних розділах описується додавання методів реалізації API.</p> <h2 id="отримання-елементів-списку-справ"><a href="#отримання-елементів-списку-справ" class="header-anchor">#</a> Отримання елементів списку справ</h2> <p>Щоб отримати елементи списку справ, додайте такі методи класу <code>TodoController</code>:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token keyword">public</span> <span class="token return-type class-name">IEnumerable<span class="token punctuation">&lt;</span>TodoItem<span class="token punctuation">&gt;</span></span> <span class="token function">GetAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> TodoItems<span class="token punctuation">.</span><span class="token function">GetAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;{id}&quot;</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;GetTodo&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IActionResult</span> <span class="token function">GetById</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> item <span class="token operator">=</span> TodoItems<span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ObjectResult</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Ці методи реалізують два методи GET:</p> <ul><li><code>GET /api/todo</code></li> <li><code>GET /api/todo/{id}</code></li></ul> <p>У цьому випадку HTTP-відповідь для методу GetAll буде такою:</p> <div class="language-cs extra-class"><pre class="language-cs"><code>HTTP<span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> OK
Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>json<span class="token punctuation">;</span> charset<span class="token operator">=</span>utf<span class="token operator">-</span><span class="token number">8</span>
Server<span class="token punctuation">:</span> Microsoft<span class="token operator">-</span>IIS<span class="token operator">/</span><span class="token number">10.0</span>
Date<span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> <span class="token number">18</span> Jun <span class="token number">2015</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">51</span><span class="token punctuation">:</span><span class="token number">10</span> GMT
Content<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">82</span>

<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;Key&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;4f67d7c5-a2a9-4aae-b030-16003dd829ae&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;Item1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;IsComplete&quot;</span><span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="маршрутизація-та-url-шляхи"><a href="#маршрутизація-та-url-шляхи" class="header-anchor">#</a> Маршрутизація та URL-шляхи</h3> <p>Атрибут <code>HttpGet</code> (<strong>HttpGetAttribute</strong>) визначає метод HTTP GET. URL-шлях для кожного методу будується так:</p> <ul><li>Візьміть рядок шаблону з атрибута route контролера: <code>[Route(&quot;api/[controller]&quot;)]</code></li> <li>Замініть [Controller] на ім'я контролера, яке ви отримаєте, взявши ім'я класу контролера та прибравши суфікс Controller. У прикладі ім'я класу контролера — <strong>TodoController</strong>, а кореневе ім'я — todo. Маршрутизація ASP.NET Core не враховує регістр.</li> <li>Якщо атрибут <code>[HttpGet]</code> має рядок шаблону, додайте його до шляху. У цьому прикладі рядок шаблону не використовується.</li></ul> <p>У методі <code>GetById</code>:</p> <div class="language-cs extra-class"><pre class="language-cs"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpGet</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;{id}&quot;</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;GetTodo&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token return-type class-name">IActionResult</span> <span class="token function">GetById</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> id<span class="token punctuation">)</span>
</code></pre></div><p><code>&quot;{id}&quot;</code> - це величина, яка замінюється на ідентифікатор елемента <code>todo</code>. Коли <code>GetById</code> викликається, значення “{id}” URL присвоюється параметру <code>id</code> методу.</p> <p><code>Name = &quot;GetTodo&quot;</code> створює іменований маршрут, що дозволяє посилатися на нього в HTTP-відповіді. Надалі це буде показано на прикладі.</p> <h3 id="значення-що-повертаються"><a href="#значення-що-повертаються" class="header-anchor">#</a> Значення, що повертаються</h3> <p>Метод <code>GetAll</code> повертає <code>IEnumerable</code>. MVC автоматично серіалізує об'єкт у JSON та записує <a href="https://www.json.org/json-en.html" target="_blank" rel="noopener noreferrer">JSON<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> у тіло відповіді. Код відповіді для цього методу — 200, якщо немає необроблених винятків (необроблені винятки переводяться в помилки 5xx.)</p> <p>У свою чергу метод <code>GetById</code> повертає значення більш загального типу <code>IActionResult</code>, який представлений великою кількістю типів значень, що повертаються. <code>GetById</code> має два різні типи значень, що повертаються:</p> <ul><li>Якщо немає відповідності запитуваному ідентифікатору, метод повертає помилку 404. Це відбувається при поверненні <code>NotFound</code>.</li> <li>В інших випадках метод повертає код 200 та тіло відповіді у форматі JSON. Це відбувається при поверненні <code>ObjectResult</code>.</li></ul> <h3 id="запуск-програми"><a href="#запуск-програми" class="header-anchor">#</a> Запуск програми</h3> <p>Натисніть клавіші CTRL+F5 у Visual Studio, щоб запустити програму. Запуститься браузер і відкриється веб-сторінка <code>http://localhost:port/api/values</code>, де <strong>port</strong> є довільним номером порту. Якщо використовується Chrome, Edge або Firefox, буде відображено дані. У разі використання IE буде запропоновано відкрити або зберегти файл <strong>values.json</strong>.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Останнє оновлення:</span> <span class="time">12/29/2021, 10:21:44 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/edu-dis-labs/design/" class="prev">
        Проєктування архітектури системи
      </a></span> <span class="next"><a href="/edu-dis-labs/test/">
        Тестування працездатності системи
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/edu-dis-labs/assets/js/app.ee704347.js" defer></script><script src="/edu-dis-labs/assets/js/2.687b822f.js" defer></script><script src="/edu-dis-labs/assets/js/21.e6303add.js" defer></script>
  </body>
</html>
